CREATE TABLE IF NOT EXISTS ingredients
(
    id  BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    name VARCHAR(255) NOT NULL,
    count INT DEFAULT 0
);

CREATE TABLE IF NOT EXISTS recipe (
    id BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    c_name VARCHAR(255) NOT NULL UNIQUE,
    quantity_buyers INT DEFAULT 0,
    cost numeric NOT NULL,
    coffee_id INT REFERENCES t_coffee(id)
);

CREATE TABLE IF NOT EXISTS recipe_ingredients (
    ingredient_id INT REFERENCES ingredients(id),
    recipe_id INT REFERENCES recipe(id),
    PRIMARY KEY (recipe_id, ingredient_id)
);
DO $$
    declare
        ingredient_row record;
    BEGIN
        FOR ingredient_row IN SELECT * FROM (VALUES
                                            ('Кофейные зерна'), ('Вода'), ('Молоко'), ('Сахар'), ('Сиропы'),
                                            ('Какао-порошок'), ('Шоколад'), ('Взбитые сливки'), ('Корица'), ('Гвоздика'), ('Ваниль'), ('Имбирь'),
                                            ('Сливки'), ('Какао-бобы'), ('Орехи'), ('Карамель')) AS t(ingredient) LOOP
                INSERT INTO ingredients(name, count) VALUES (ingredient_row.ingredient, 100);
            END LOOP;
    END $$;
